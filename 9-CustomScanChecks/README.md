# 自定义扫描检查示例扩展
============================

###### 实现自定义检查以扩展 Burp Suite 的主动和被动扫描引擎功能

---

## 扩展功能说明

本示例扩展展示了如何为 Burp Suite 的扫描引擎添加自定义的安全检查功能。它能够执行主动和被动扫描，检测特定的安全漏洞和敏感信息泄露。

### 主要特性

- 注册自定义扫描检查
- 支持用户触发的主动和被动扫描
- 使用 Burp 提供的 `AuditInsertionPoint` 构建包含指定有效载荷的请求
- 提供辅助方法在响应中搜索相关匹配字符串
- 使用 `MarkedHttpRequestResponse` 高亮显示请求和响应中的相关部分
- 同步报告自定义扫描问题
- 指导 Burp 在相同 URL 上合并重复问题

### 技术实现

1. 主动扫描检查：
   - 检测命令注入漏洞
   - 使用管道字符（|）作为测试字符串
   - 分析响应中的错误信息

2. 被动扫描检查：
   - 检测 CMS 信息泄露
   - 搜索响应中的特定字符串
   - 标记敏感信息位置

3. 问题处理：
   - 自动合并重复问题
   - 提供问题严重程度和置信度
   - 支持问题高亮显示

### 使用场景

- 检测命令注入漏洞
- 发现 CMS 信息泄露
- 自动化安全测试
- 提高扫描覆盖率和准确性

### 注意事项

- 主动扫描可能会对目标系统产生影响
- 需要合理配置扫描参数
- 建议在测试环境中充分验证
- 注意扫描频率和并发数

### 扩展配置

1. 安装扩展：
   - 将编译后的 JAR 文件加载到 Burp Suite
   - 确保扩展已正确启用

2. 使用方式：
   - 在 Burp Suite 的扫描器中使用
   - 配置扫描范围和参数
   - 查看扫描结果和问题详情

3. 调试建议：
   - 使用 Burp Suite 的日志功能
   - 检查扫描请求和响应
   - 验证问题标记的准确性

### 开发说明

1. 扩展结构：
   - `CustomScanChecks`：扩展入口类
   - `MyScanCheck`：扫描检查实现类

2. 关键接口：
   - `ScanCheck`：扫描检查接口
   - `AuditInsertionPoint`：审计插入点接口
   - `AuditIssue`：审计问题接口

3. 开发建议：
   - 遵循 Burp Suite 的扩展开发规范
   - 合理处理异常情况
   - 优化扫描性能
   - 提供清晰的错误信息