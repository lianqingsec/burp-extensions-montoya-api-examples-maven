# 流量重定向器示例扩展

###### 将所有出站请求从一个主机重定向到另一个主机。

---

## 扩展说明

这个扩展演示了如何将出站 HTTP 请求从一个主机重定向到另一个主机。这种功能在以下场景中非常有用：
- 当应用程序迁移到新的测试环境 URL 时
- 需要在不同环境之间切换测试时
- 进行负载均衡测试时
- 开发环境调试时

通过简单地重定向流量到新的主机名，您可以继续使用原有的站点地图进行测试。

## 工作原理

扩展的工作流程如下：
1. 注册一个 HTTP 处理器
2. 对于出站请求消息：
   - 获取请求的 HTTP 服务信息
   - 如果 HTTP 服务的主机名匹配"源"主机
   - 使用"目标"主机构建新的 HTTP 服务，保持其他细节不变
   - 返回带有新 HTTP 服务的请求

## 配置说明

1. **主机配置**
   - 源主机：`host1.example.org`
   - 目标主机：`host2.example.org`
   - 端口和协议（HTTP/HTTPS）保持不变

2. **修改配置**
   - 打开 `TrafficRedirector.java` 文件
   - 修改 `HOST_FROM` 和 `HOST_TO` 常量的值
   - 重新编译扩展

## 使用说明

1. **编译扩展**
   ```bash
   mvn clean package
   ```

2. **加载扩展**
   - 打开 Burp Suite
   - 进入 Extender 标签页
   - 点击 "Add" 按钮
   - 选择编译好的 jar 文件

3. **验证重定向**
   - 发送请求到源主机
   - 检查请求是否被重定向到目标主机
   - 验证 Host 头部是否正确更新

## 注意事项

1. **配置修改**
   - 使用前请确保修改了正确的源主机和目标主机
   - 确保目标主机能够处理重定向的请求

2. **安全考虑**
   - 重定向可能会影响应用程序的安全性测试
   - 确保了解重定向对测试结果的影响

3. **性能影响**
   - 重定向会增加请求处理时间
   - 在高并发场景下需要注意性能影响

4. **调试建议**
   - 使用 Burp Suite 的日志功能监控重定向过程
   - 检查请求和响应的详细信息
   - 验证 Host 头部是否正确更新

## 常见问题

1. **重定向不生效**
   - 检查主机名配置是否正确
   - 验证请求是否匹配源主机
   - 检查网络连接是否正常

2. **Host 头部未更新**
   - 检查请求处理逻辑
   - 验证 HTTP 服务对象是否正确创建

3. **SSL/TLS 问题**
   - 确保目标主机的 SSL 证书有效
   - 检查 HTTPS 连接是否正常