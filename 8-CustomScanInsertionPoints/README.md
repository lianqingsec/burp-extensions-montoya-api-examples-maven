# 自定义扫描检查示例扩展
============================

###### 为主动扫描提供自定义攻击插入点

---

## 扩展功能说明

本示例扩展展示了如何为 Burp Suite 的主动扫描功能提供自定义的攻击插入点。它能够识别和处理包含特定参数（data）的请求，并为其提供自定义的审计插入点。

### 主要特性

- 注册自定义的 `AuditInsertionPointProvider`
- 自动检测请求中的 `data` 参数
- 为包含 `data` 参数的请求提供自定义的 `AuditInsertionPoint`
- 支持对序列化数据进行处理

### 技术实现

自定义的 `AuditInsertionPoint` 实现了以下功能：

1. 数据反序列化处理：
   - 首先进行 URL 解码
   - 然后进行 Base64 解码

2. 输入位置解析：
   - 在解码后的数据中定位 `input=` 字符串
   - 将数据分为前缀、有效载荷位置和后缀三部分

3. 请求构建处理：
   - 使用指定的有效载荷构建原始数据
   - 重新序列化数据：
     - 首先进行 Base64 编码
     - 然后进行 URL 编码

### 使用场景

- 处理包含序列化数据的 HTTP 请求
- 对 Base64 编码的参数进行安全测试
- 自动化处理复杂的参数格式
- 提高扫描的覆盖率和准确性

### 注意事项

- 仅处理包含 `data` 参数的请求
- 需要确保数据格式符合预期（包含 `input=` 字符串）
- 序列化和反序列化过程需要保持一致性
- 建议在测试环境中充分验证后再用于生产环境

### 扩展配置

1. 安装扩展：
   - 将编译后的 JAR 文件加载到 Burp Suite
   - 确保扩展已正确启用

2. 使用方式：
   - 在 Burp Suite 的扫描器中使用
   - 自动检测和处理符合条件的请求
   - 查看扫描结果中的自定义插入点测试

3. 调试建议：
   - 使用 Burp Suite 的日志功能监控处理过程
   - 检查序列化和反序列化是否正确
   - 验证有效载荷的插入位置是否准确